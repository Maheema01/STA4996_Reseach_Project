---
title: "EDA"
output:
  html_document:
    df_print: paged
date: "2025-06-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(maps)
library(viridis)
library(tidyverse)
library(DataExplorer)
library(corrplot)
library(ggpubr)
library(GGally)
library(reshape2)
library(scales)
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)
library(naniar)
library(tidyr)
library(stringr)

```

```{r}
data <- read.csv("G:/STA4996_Research/data/Nutrition.csv")
```


```{r}
#head(data)
```

```{r}

colSums(is.na(data))
```

```{r}
colnames(data)[1:25] <- c("Country", "Year","UN_Region", "UN_sub_region", "Stunting_survey","Stunting_model","Underweight_survey", "Wasting_survey","Overweight_survey","Overweight_model","WHZ_sample_size","HAZ_sample_size","WAZ_sample_size","U5_population", "hcpi_a","fcpi_a","def_a","literacy_female","literacy_tot","health_expenditure","Urban_pop","rural_pop","inf_mortality","LBW","UnemploymentRate")

```
#Selected countries

```{r}

selected_countries <- c("Afghanistan", "Bangladesh", "Bolivia", "Botswana", "Brazil", "Chile", "Colombia","Congo", "Egypt","Ethiopia", "Iran", "India", "Kenya", "Madagascar","Malaysia", "Maldives", "Mali", "Mauritius", "Mexico","Morocco", "Myanmar", "Nepal", "Nigeria", "Pakistan", "Panama", "Peru","South Africa", "Sri Lanka", "Sudan", "Thailand","Venezuela","Vietnam","Zimbabwe", "Albania", "Azerbaijan", "Tajikistan", "Turkey","Rwanda","Niger","Malawi","Mautitania","Jamaica","Indonesia","Uganda","Senegal","Burkina Faso","Burubdi","Chad","Gambia","Kuweit","Togo","Tanzania","Uruguay")
```

```{r}
unique(data$Country)

```


```{r}
world <- ne_countries(scale = "medium", returnclass = "sf")


world$highlight <- ifelse(world$name %in% selected_countries, "Selected", "Other")


ggplot(data = world) +
  geom_sf(aes(fill = highlight)) +
  scale_fill_manual(values = c("Selected" = "tomato", "Other" = "gray90")) +
  theme_minimal() +
  labs(title = "Highlighted Countries on World Map",
       fill = "Country Type")
```



#Missing values 

```{r}
vis_miss(data)          
miss_var_summary(data)  
colMeans(is.na(data)) * 100
```
By omitting the predictor variables more than 50% of missing values, the selected socioeconomic factors are:

hcpi_a
fcpi_a
def_a
Current health expenditure(% if GDP)
urban population(% of total population)
mortality rate under 5
Low birth weight babies
unemployment rate 


# Distribution of response variables 

Stunting
```{r}
# Histograms & density
ggplot(data, aes(x = Stunting_model)) +
  geom_histogram(bins = 30, fill = "skyblue", alpha = 0.7) +
  geom_density(aes(y = ..count..), color = "darkblue") +
  theme_minimal()


```

The distribution is multi-modal (Multiple peaks)
This indicates that different countries or time periods may cluster around different stunting levels.

The highest concentrations of observations appear between 10% and 40% with several mini-peaks 

The distribution has a slightly right skew: there are some countries or years with very high stunting percentages, though most values are in the lower-to-mid range.

Long tail extending beyond 50%: high stunting in certain countries or time periods, which might act as outliers in modeling.



overweight

```{r}

ggplot(data, aes(x = Overweight_model)) +
  geom_histogram(bins = 30, fill = "salmon", alpha = 0.7) +
  geom_density(aes(y = ..count..), color = "darkred") +
  theme_minimal()
```

Right skewed

There is one clear peak around 0-2% overweight prevalence. (unimodal)
not normally distributed
the most values appear to be around 0-2%


#Correlation Analysis

```{r}

selected_df <- data %>%
  select(Stunting_model,Stunting_survey,Overweight_model,Overweight_survey,Underweight_survey,Wasting_survey,hcpi_a,fcpi_a,def_a, U5_population,Urban_pop,rural_pop,UnemploymentRate,LBW,inf_mortality,health_expenditure)


cor_matrix <- cor(selected_df, use = "complete.obs")


corrplot::corrplot(cor_matrix,
                   method = "color",
                   col = colorRampPalette(c("blue", "white", "red"))(200),
                   type = "upper",
                   tl.cex = 0.6,
                   number.cex = 0.45,
                   addCoef.col = "black",
                   tl.col = "black",
                   diag=FALSE)
```

#Outlier detction

```{r}
data %>%
  select(Country, Stunting_model, Overweight_model) %>%
  pivot_longer(cols = c(Stunting_model, Overweight_model), names_to = "indicator") %>%
  ggplot(aes(x = indicator, y = value)) +
  geom_boxplot(fill = "lightblue") +
  theme_minimal()

```
Box plots compare the distributions of overweight and stunting rates across countries.

overweight:

median is around 5-6% and the IQR is narrow
multiple outliers clustered around 15-25%,indicating several countries with unusually high overweight rates

stunting:

median is around 25-27% and the IQR is much wider 
Whiskers extend from about 2% to roughly 62%
no visible outliers, suggesting the whiskers capture the full range
more normally distributed

patterns:

most countries face low overweight but moderate-to-high stunting
few countries have severe overweight problems 
the dual burden exists but is asymmetric across the global landscape

##By country

Bar chart of average by country 

```{r}

data %>%
  group_by(Country) %>%
  summarise(across(c(Stunting_model, Overweight_model), mean, na.rm = TRUE)) %>%
  pivot_longer(cols = -Country, names_to = "indicator", values_to = "mean_val") %>%
  mutate(Country = str_wrap(Country, width = 16)) %>%  # Optional: wrap long names
  ggplot(aes(x = reorder(Country, mean_val), y = mean_val, fill = indicator)) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.y = element_text(size = 6),
    axis.text.x = element_text(size = 9),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 9),
    plot.title = element_text(size = 14)
  ) +
  labs(
    x = "Country",
    y = "Mean Prevalence (%)",
    title = "Average Stunting and Overweight Prevalence by Country",
    fill = "Indicator"
  )

```
High prevalence in stunting than the overweight across the selected countries. 
Countries at the top (Burundi, Afghanistan... ) have high combined rates of stunting and overweight.

Dual burden pattern can be seen: some countries show significant levels of both indicators.Ex: Egypt, South Africa. This indicates the prevalence of double burden of malnutrition.

Transition pattern: As move down the chart, there is generally a shift from stunting-dominant to more balanced or overweight-dominant patterns, but this is not perfectly linear

This suggests different countries face different malnutrition challenges. 

some countries are  primarily dealing with undernutrition con (stunting), others with a mixed burden. 


#Overweight

```{r}
overweight_data <- data %>%
  select(Country, Year, Overweight_model) %>%
  filter(!is.na(Overweight_model))
#overweight_data
```


```{r}

countries <- unique(overweight_data$Country)


for(country in countries) {
  country_data <- overweight_data %>% filter(Country == country)
  
  p <- ggplot(country_data, aes(x = Year, y = Overweight_model)) +
    geom_line(color = "steelblue", size = 1) +
    geom_point(color = "steelblue", size = 2) +
    labs(title = paste("Prevalence of Overweight in", country),
         x = "Year",
         y = "Overweight Prevalence (%)") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
  
  print(p)
  
  
  ggsave(paste0("overweight_", gsub(" ", "_", country), ".png"), plot = p, width = 8, height = 6)
}
```

countries from the same region and the same sub-region shows different prevalence in overweight. ex: Uruguay, Bolivia, Brazil

most of the countries have declining patterns 

```{r}
data$Year <- as.numeric(data$Year)
```



```{r}
data_filtered <- data %>%
  filter(Country %in% selected_countries & !is.na(Overweight_model)) %>%
  group_by(Country) %>%
  filter(Year == max(Year, na.rm = TRUE)) %>%
  select(Country, Year, Overweight_model)

```

```{r}
world_map <- map_data("world")
```


```{r}

highlighted_map <- world_map %>%
  filter(region %in% selected_countries) %>%
  left_join(data_filtered, by = c("region" = "Country"))
```



```{r}

highlighted_map <- highlighted_map %>%
  mutate(
    Year = as.numeric(year),  # Ensure 'year' column exists
    Period = case_when(
      Year >= 2000 & Year < 2005 ~ "2000–2004",
      Year >= 2005 & Year < 2010 ~ "2005–2009",
      Year >= 2010 & Year < 2015 ~ "2010–2014",
      Year >= 2015 & Year < 2020 ~ "2015–2019",
      Year >= 2020 ~ "2020+",
      TRUE ~ NA_character_
    )
  )


avg_overweight <- highlighted_map %>%
  group_by(region, Period) %>%  
  summarise(Overweight = mean(as.numeric(Overweight_model), na.rm = TRUE)) %>%
  ungroup()


map_data_period <- highlighted_map %>%
  select(long, lat, group, region, Period) %>% 
  distinct() %>%
  left_join(avg_overweight, by = c("region", "Period"))

ggplot() +
  geom_polygon(
    data = world_map, 
    aes(x = long, y = lat, group = group),
    fill = "lightgray", 
    color = "white",
    linewidth = 0.1
  ) +
  geom_polygon(
    data = map_data_period,
    aes(x = long, y = lat, group = group, fill = Overweight),
    color = "black",
    linewidth = 0.2
  ) +
  scale_fill_viridis(
    name = "Avg Overweight %", 
    option = "plasma", 
    direction = -1, 
    na.value = "grey90",
    limits = c(0, 100)
  ) +
  coord_fixed(ratio = 1.3) +
  theme_minimal() +
  labs(
    title = "Average Overweight Percentage by Country (5-Year Periods)",
    x = "Longitude", 
    y = "Latitude"
  ) +
  facet_wrap(~ Period) +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  )

```






#Stunting



```{r}

stunting_data <- data %>%
  select(Country, Year, Stunting_model) %>%
  filter(!is.na(Stunting_model))

stunting_data$Stunting <- as.numeric(stunting_data$Stunting)
stunting_data$Year <- as.numeric(as.character(stunting_data$Year))


countries <- unique(stunting_data$Country)


y_max <- max(stunting_data$Stunting, na.rm = TRUE)


for (country in countries) {
  country_data <- stunting_data %>% filter(Country == country)
  
  if (nrow(country_data) < 2) next  # Skip if not enough data

  p <- ggplot(country_data, aes(x = Year, y = Stunting_model)) +
    geom_line(color = "#E69F00", size = 1) +
    geom_point(color = "#E69F00", size = 2) +
    labs(title = paste("Prevalence of Stunting in", country),
         x = "Year",
         y = "Stunting Prevalence (%)") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_cartesian(ylim = c(0, y_max))

  print(p)

  
  safe_country <- gsub("[^A-Za-z0-9_]", "_", country)
  ggsave(filename = paste0("stunting_", safe_country, ".png"),
         plot = p, width = 8, height = 6, dpi = 300)
}
```

almost all countries have similar prevelance of stuning over time 

```{r}
data_filtered_st <- data %>%
  filter(Country %in% selected_countries & !is.na(Stunting_model)) %>%
  group_by(Country) %>%
  filter(Year == max(Year, na.rm = TRUE)) %>%
  select(Country, Year, Stunting_model)
```

```{r}
world_map1 <- map_data("world")
```

```{r}
highlighted_map1 <- world_map1 %>%
  filter(region %in% selected_countries) %>%
  left_join(data_filtered_st, by = c("region" = "Country"))
```

```{r}

highlighted_map <- world_map %>%
  left_join(stunting_data, by = c("region" = "Country"))


highlighted_map$Stunting <- as.numeric(highlighted_map$Stunting)


ggplot() +
  geom_polygon(
    data = world_map,
    aes(x = long, y = lat, group = group),
    fill = "lightgray", color = "white", linewidth = 0.1
  ) +
  geom_polygon(
    data = highlighted_map,
    aes(x = long, y = lat, group = group, fill = Stunting),
    color = "black", linewidth = 0.2
  ) +
  scale_fill_viridis(
    name = "Stunting (%)",
    option = "plasma", direction = -1, na.value = "grey90",
    limits = c(0, max(highlighted_map$Stunting, na.rm = TRUE))
  ) +
  coord_fixed(ratio = 1.3) +
  theme_minimal() +
  labs(title = "Stunting Percentage by Country", x = "Longitude", y = "Latitude") +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )
```

Q-Q plots for stunting



```{r}
ggqqplot(data$Stunting_model, title = "QQ Plot - Stunting")

```

the stunting data is not perfectly normally distributed.

#Overweight

```{r}
df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = Overweight_model)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Overweight_model by Country in", year),
         x = "Country", y = "Overweight_model (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}


```



```{r}

df_filtered1 <- data %>% 
  filter(Year >= 2000 & Year <= 2022)

years <- sort(unique(df_filtered1$Year))


for (year in years) {
  yearly_data <- df_filtered1 %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = Stunting_model)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Stunting_model by Country in", year),
         x = "Country", y = "Stunting_model (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}

```

```{r}
summary_stats <- data %>%
  group_by(Year) %>%
  summarise(
    Mean_Stunting = mean(Stunting_model, na.rm = TRUE),
    Median_Stunting = median(Stunting_model, na.rm = TRUE),
    Min_Stunting = min(Stunting_model, na.rm = TRUE),
    Max_Stunting = max(Stunting_model, na.rm = TRUE),
    .groups = "drop"
  )

print(summary_stats)

```


```{r}
ggplot(data, aes(x = factor(Year), y = Stunting_model)) +
  geom_boxplot(fill = "skyblue") +
  labs(
    title = "Distribution of Stunting Prevalence by Year",
    x = "Year",
    y = "Stunting Prevalence (%)"
  ) +
  theme_minimal()

```


```{r}
ggplot(
  data %>% filter(Country %in% selected_countries),
  aes(x = Year, y = Stunting_model, color = Country, group = Country)
) +
  geom_line(size = 1.2) +
  geom_point() +
  labs(
    title = "Trends in Stunting Prevalence (2000–2022)",
    x = "Year",
    y = "Stunting Prevalence (%)"
  ) +
  theme_minimal()

```



```{r}
df_filtered1 <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered1$Year))


for (year in years) {
  yearly_data <- df_filtered1 %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = Stunting_survey)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Stunting_survey by Country in", year),
         x = "Country", y = "Stunting_survey (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```

```{r}
df_filtered1 <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered1$Year))


for (year in years) {
  yearly_data <- df_filtered1 %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = Overweight_survey)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Overweight_survey by Country in", year),
         x = "Country", y = "Overweight_survey (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```

```{r}
ggplot(data, aes(x = factor(Year), y = Overweight_model)) +
  geom_boxplot(fill = "skyblue") +
  labs(
    title = "Distribution of Overweight Prevalence by Year",
    x = "Year",
    y = "Overweight Prevalence (%)"
  ) +
  theme_minimal()

```


```{r}
summary_stats <- data %>%
  group_by(Year) %>%
  summarise(across(where(is.numeric), 
                   .fns = list(
                     mean = \(x) mean(x, na.rm = TRUE),
                     median = \(x) median(x, na.rm = TRUE),
                     sd = \(x) sd(x, na.rm = TRUE)
                   )))
summary_stats
```

```{r}
min(summary_stats$Stunting_model_sd)
max(summary_stats$Stunting_model_sd)
```

```{r}
data$Year <- as.numeric(as.character(data$Year))

```



```{r}

nutrition_data$Year <- as.numeric(as.character(nutrition_data$Year))

nutrition_data <- nutrition_data %>%
  mutate(Year_Group = cut(Year,
                          breaks = c(2000, 2005, 2010, 2015, 2020, 2025),
                          labels = c("2000-2004", "2005-2009", "2010-2014", "2015-2019", "2020-2024"),
                          right = FALSE,
                          include.lowest = TRUE))

stunting_summary <- nutrition_data %>%
  group_by(Country, Year_Group) %>%
  summarise(Stunting_Avg = mean(Stunting_model, na.rm = TRUE)) %>%
  ungroup()


print(stunting_summary)


```


```{r}
ggplot(stunting_summary, aes(x = Year_Group, y = Stunting_Avg, group = Country, color = Country)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = "Stunting Prevalence by Country (5-year averages)",
       x = "Year Group",
       y = "Average Stunting (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


```{r}
ggplot(stunting_summary, aes(x = Year_Group, y = reorder(Country, -Stunting_Avg), fill = Stunting_Avg)) +
  geom_tile(color = "white") +
  scale_fill_viridis_c(name = "Stunting Avg", option = "D") +
  theme_minimal(base_size = 12) +
  labs(title = "Stunting Prevalence Heatmap by Country and Time Period",
       x = "Year Group",
       y = "Country") +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text.y = element_text(size = 7, hjust = 1),
    plot.margin = margin(10, 20, 10, 10)
  )


```



```{r}
ggplot(stunting_summary, aes(x = Year_Group, y = Stunting_Avg, group = Country)) +
  geom_line(color = "steelblue") +
  geom_point(color = "steelblue") +
  facet_wrap(~ Country, scales = "free_y") +
  theme_minimal() +
  labs(title = "Stunting Prevalence by Country (5-year averages)",
       x = "Year Group",
       y = "Average Stunting (%)") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

```{r}
nutrition_data <- data %>%
  filter(!is.na(Year)) %>%  # make sure no missing years
  mutate(
    Year = as.numeric(Year),  # convert if needed
    Year_Bin_Start = 2000 + 5 * floor((Year - 2000) / 5),
    Year_Bin_Label = paste0(Year_Bin_Start, "-", Year_Bin_Start + 4)
  )

```

```{r}
table(nutrition_data$Year_Bin_Label)
```

```{r}
stunting_summary <- nutrition_data %>%
  group_by(UN_Region, Country, Year_Bin_Label) %>%
  summarise(Stunting_Avg = mean(Stunting_model, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
ggplot(stunting_summary, aes(x = Year_Bin_Label, y = Stunting_Avg, group = Country, color = Country)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ UN_Region, scales = "free_y") +
  theme_minimal() +
  labs(title = "Stunting Prevalence by Country and Region (5-year Averages)",
       x = "5-Year Period",
       y = "Stunting Prevalence (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")

```

```{r}
stunting_summary <- nutrition_data %>%
  group_by(UN_sub_region, Country, Year_Bin_Label) %>%
  summarise(Stunting_Avg = mean(Stunting_model, na.rm = TRUE)) %>%
  ungroup()
```

```{r}
ggplot(stunting_summary, aes(x = Year_Bin_Label, y = Stunting_Avg, group = Country, color = Country)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ UN_sub_region, scales = "free_y") +
  theme_minimal() +
  labs(title = "Stunting Prevalence by Country and Sub Region (5-year Averages)",
       x = "5-Year Period",
       y = "Stunting Prevalence (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")
```




```{r}
nutrition_data <- data %>%
  filter(!is.na(Year)) %>%  # make sure no missing years
  mutate(
    Year = as.numeric(Year),  # convert if needed
    Year_Bin_Start = 2000 + 5 * floor((Year - 2000) / 5),
    Year_Bin_Label = paste0(Year_Bin_Start, "-", Year_Bin_Start + 4)
  )

```


```{r}
overweight_summary <- nutrition_data %>%
  group_by(UN_Region, Country, Year_Bin_Label) %>%
  summarise(overweight_Avg = mean(Overweight_model, na.rm = TRUE)) %>%
  ungroup()

```

```{r}
ggplot(overweight_summary, aes(x = Year_Bin_Label, y = overweight_Avg, group = Country, color = Country)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ UN_Region, scales = "free_y") +
  theme_minimal() +
  labs(title = "Overweight Prevalence by Country and Region (5-year Averages)",
       x = "5-Year Period",
       y = "Overweight Prevalence (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")
```

```{r}
overweight_summary <- nutrition_data %>%
  group_by(UN_sub_region, Country, Year_Bin_Label) %>%
  summarise(overweight_Avg = mean(Overweight_model, na.rm = TRUE)) %>%
  ungroup()
```


```{r}
ggplot(overweight_summary, aes(x = Year_Bin_Label, y = overweight_Avg, group = Country, color = Country)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ UN_sub_region, scales = "free_y") +
  theme_minimal() +
  labs(title = "Overweight Prevalence by Country and Sub Region (5-year Averages)",
       x = "5-Year Period",
       y = "Overweight Prevalence (%)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none")
```

```{r}
stunting_summary <- data %>%
  group_by(Year) %>%
  summarise(
    Mean = mean(Stunting_model, na.rm = TRUE),
    Median = median(Stunting_model, na.rm = TRUE),
    SD = sd(Stunting_model, na.rm = TRUE),
    Min = min(Stunting_model, na.rm = TRUE),
    Max = max(Stunting_model, na.rm = TRUE),
    Count = n(),
    Missing = sum(is.na(Stunting_model))
  )

print(stunting_summary)

```


```{r}
ggplot(data, aes(x = Stunting_model)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  facet_wrap(~ Year) +
  theme_minimal() +
  labs(
    title = "Distribution of Stunting_model by Year",
    x = "Stunting_model (%)",
    y = "Count"
  )

```

```{r}
overweight_summary <- data %>%
  group_by(Year) %>%
  summarise(
    Mean = mean(Overweight_model, na.rm = TRUE),
    Median = median(Stunting_model, na.rm = TRUE),
    SD = sd(Overweight_model, na.rm = TRUE),
    Min = min(Overweight_model, na.rm = TRUE),
    Max = max(Overweight_model, na.rm = TRUE),
    Count = n(),
    Missing = sum(is.na(Overweight_model))
  )

print(overweight_summary)

```

```{r}
ggplot(data, aes(x = Overweight_model)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  facet_wrap(~ Year) +
  theme_minimal() +
  labs(
    title = "Distribution of Overweight_model by Year",
    x = "Overweight_model (%)",
    y = "Count"
  )

```


```{r}
ggplot(data, aes(x = def_a, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "darkgreen") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs GDP deflator by Year",
    x = "GDP deflator (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()

```


```{r}
ggplot(data, aes(x = hcpi_a, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "pink") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs food price index by Year",
    x = "Food price index (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()

```


```{r}
ggplot(data, aes(x = hcpi_a, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "blue") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs Headline Consumer Price Index by Year",
    x = "Headline Consumer Price Index (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()

```


```{r}
ggplot(data, aes(x = LBW, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "red") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs Low Birth Weight Percentage by Year",
    x = " Low Birth Weight Percentage (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()
```


```{r}
ggplot(data, aes(x = U5_population, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "green") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs Population Under five by Year",
    x = " Population under five years (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()
```

```{r}
ggplot(data, aes(x = inf_mortality, y = Stunting_model)) +
  geom_point(alpha = 0.6, color = "red") +
  facet_wrap(~ Year, scales = "free") +
  labs(
    title = "Stunting Model vs Mortality rate of children under five years of age by Year",
    x = " Infant mortality rate (%)",
    y = "Stunting Model (%)"
  ) +
  theme_minimal()
```



```{r}

df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = def_a)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("GDP deflator by Country in", year),
         x = "Country", y = "GDP delator (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}

```

```{r}
df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = U5_population)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Under five population by Country in", year),
         x = "Country", y = "Under five population") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```

```{r}
df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = rural_pop)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Rural population by Country in", year),
         x = "Country", y = "Rural population (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```


```{r}
df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = LBW)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Low Birth Weight rate by Country in", year),
         x = "Country", y = "Low birth weight rate") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```

```{r}
df_filtered <- data %>% 
  filter(Year >= 2000 & Year <= 2022)


years <- sort(unique(df_filtered$Year))


for (year in years) {
  yearly_data <- df_filtered %>% filter(Year == year)
  
  p <- ggplot(yearly_data, aes(x = Country, y = inf_mortality)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    labs(title = paste("Under five mortality rate by Country in", year),
         x = "Country", y = "Under five mortality (%)") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
  print(p)
}
```

